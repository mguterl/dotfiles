#!/bin/bash

set -eufo pipefail

{{- if eq .chezmoi.os "darwin" }}

brew install chezmoi coreutils curl ffmpeg fzf git gh jq ripgrep starship tree
brew install fontforge
brew install neovim tmux reattach-to-user-namespace luarocks
brew install --cask 1password 1password-cli
brew install --cask alfred karabiner-elements keepingyouawake obsidian rectangle
brew install --cask iterm2 monodraw visual-studio-code
brew install --cask spotify notunes
brew install --cask discord slack

{{ if .personal -}}

brew install asimov qmk/qmk/qmk yt-dlp
brew install --cask anylist backblaze bartender daisydisk docker dropbox firefox google-chrome iina istat-menus mullvadvpn omnifocus soundsource the-unarchiver vlc zoom

{{- end }} # personal

{{- end }} # darwin

{{- if eq .chezmoi.os "linux" }}
sudo apt-get update

# install ripgrep
if ! command -v rg &> /dev/null; then
  sudo apt-get install -y ripgrep
fi

# install fzf
if [ ! -d ~/.fzf ]; then
    git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf
    ~/.fzf/install --completion --no-bash --no-update-rc --key-bindings
fi

# install ohmyzsh
sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)" "" --unattended

# install zsh-autosuggestions
git clone https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions

# install starship
curl -sS https://starship.rs/install.sh | sh -s -- -y
{{- end }} # linux
